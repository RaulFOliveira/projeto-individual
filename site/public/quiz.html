<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/style.css">
    <title>Info Timão</title>
    <script src="../js/funcoes.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <!-- COMEÇO HEADER -->
    <div class="header">
        <div class="container">
            <div class="titulo">
                <h1 class="titulo1">Info</h1>
                <img src="assets/imgs/corinthians.png" alt="Brasão do Corinthians">
                <h1 class="titulo2">Timão</h1>
            </div>
            <div class="usuario">
                Olá, <span id="b_usuario"> usuário</span>
            </div>
        </div>
    </div>
    <!-- FIM HEADER -->

    <div class="quiz">
        <div class="container">
            <div class="quiz-perguntas">
                <div class="perguntas" id="pergunta1" style="display: block;">
                    <h1>Qual foi a maior goleada do Corinthians?</h1>

                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="1" value="Corinthians 6x1 São Paulo"
                                onclick="pgt1()">
                            <label for="1">Corinthians 6x1 São Paulo</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="2" value="Corinthians 8x2 Cerro Porteño"
                                onclick="pgt1()">
                            <label for="2">Corinthians 8x2 Cerro Porteño</label>
                        </div>
                    </div>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="3" value="Corinthians 11x0 Santos" onclick="pgt1()">
                            <label for="3">Corinthians 11x0 Santos</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="4" value="Corinthians 6x0 Deportivo Táchira"
                                onclick="pgt1()">
                            <label for="4">Corinthians 6x0 Deportivo Táchira</label>
                        </div>
                    </div>
                </div>
                <div class="perguntas" id="pergunta2" style="display: none;">
                    <h1>Em que ano essa camisa foi lançada?</h1>
                    <div class="imagem" style="text-align: center;"><img
                            src="https://brechodofutebol.com/wp-content/uploads/2022/02/Sem20tedtulo1_0028_Foto2017-04-2021201720422034-1.jpg-1-383x510.jpg"
                            alt="" style="width: 30%; text-align: center;"></div>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="5" value="2013" onclick="pgt2()">
                            <label for="5">2013</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="6" value="2014" onclick="pgt2()">
                            <label for="6">2014</label>
                        </div>
                    </div>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="7" value="2019" onclick="pgt2()">
                            <label for="7">2019</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="8" value="2010" onclick="pgt2()">
                            <label for="8">2010</label>
                        </div>
                    </div>
                </div>
                <div class="perguntas" id="pergunta3" style="display: none;">
                    <h1>Quem é maior goleador da Neo Química Arena?</h1>

                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="9" value="Jô" onclick="pgt3()">
                            <label for="9">Jô</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="10" value="Romero" onclick="pgt3()">
                            <label for="10">Romero</label>
                        </div>
                    </div>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="11" value="Guerrero" onclick="pgt3()">
                            <label for="11">Guerrero</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="12" value="Emerson Sheik" onclick="pgt3()">
                            <label for="12">Emerson Sheik</label>
                        </div>
                    </div>
                </div>
                <div class="perguntas" id="pergunta4" style="display: none;">
                    <h1>Qual o ano o Corinthians foi conhecido como "O time que não sabia perder"?</h1>

                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="13" value="2012" onclick="pgt4()">
                            <label for="13">2012</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="14" value="2015" onclick="pgt4()">
                            <label for="14">2015</label>
                        </div>
                    </div>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="15" value="2017" onclick="pgt4()">
                            <label for="15">2017</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="16" value="2011" onclick="pgt4()">
                            <label for="16">2011</label>
                        </div>
                    </div>
                </div>
                <div class="perguntas" id="pergunta5" style="display: none;">
                    <h1>Quem foi o goleiro do Corinthians no Mundial de 2000?</h1>

                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="17" value="Dida" onclick="pgt5()">
                            <label for="17">Dida</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="18" value="Felipe" onclick="pgt5()">
                            <label for="18">Felipe</label>
                        </div>
                    </div>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="19" value="Júlio Cesar" onclick="pgt5()">
                            <label for="19">Júlio Cesar</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="20" value="Ronaldo Giovanelli" onclick="pgt5()">
                            <label for="20">Ronaldo Giovanelli</label>
                        </div>
                    </div>
                </div>
                <div class="perguntas" id="pergunta6" style="display: none;">
                    <h1>Quais desses jogadores jogou na base do Corinthians mas foi revelado por outro clube?</h1>

                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="21" value="Weverton" onclick="pgt6()">
                            <label for="21">Weverton</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="22" value="Lucas Moura" onclick="pgt6()">
                            <label for="22">Lucas Moura</label>
                        </div>
                    </div>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="23" value="Giovanni" onclick="pgt6()">
                            <label for="23">Giovanni</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="24" value="Éverton Ribeiro" onclick="pgt6()">
                            <label for="24">Éverton Ribeiro</label>
                        </div>
                    </div>
                </div>
                <div class="perguntas" id="pergunta7" style="display: none;">
                    <h1>Em qual ano aconteceu a Invasão Corinthiana?</h1>

                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="25" value="2000" onclick="pgt7()">
                            <label for="25">2000</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="26" value="2012" onclick="pgt7()">
                            <label for="26">2012</label>
                        </div>
                    </div>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="27" value="1977" onclick="pgt7()">
                            <label for="27">1977</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="28" value="1976" onclick="pgt7()">
                            <label for="28">1976</label>
                        </div>
                    </div>
                </div>
                <div class="perguntas" id="pergunta8" style="display: none;">
                    <h1>Qual é o jogador com mais jogos com a camisa do Corinthians?</h1>

                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="29" value="Rivelino" onclick="pgt8()">
                            <label for="29">Rivelino</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="30" value="Cássio" onclick="pgt8()">
                            <label for="30">Cássio</label>
                        </div>
                    </div>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="31" value="Wladimir" onclick="pgt8()">
                            <label for="31">Wladimir</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="32" value="Cláudio" onclick="pgt8()">
                            <label for="32">Cláudio</label>
                        </div>
                    </div>
                </div>
                <div class="perguntas" id="pergunta9" style="display: none;">
                    <h1>De qual ano é essa camisa?</h1>
                    <div class="imagem" style="text-align: center;">
                        <img src="https://cdn.meutimao.com.br/_upload/camisas-do-corinthians/2009-camisa_iii_roxa.jpg"
                            alt="">
                    </div>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="33" value="2008" onclick="pgt9()">
                            <label for="33">2008</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="34" value="2005" onclick="pgt9()">
                            <label for="34">2005</label>
                        </div>
                    </div>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="35" value="2009" onclick="pgt9()">
                            <label for="35">2009</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="36" value="2010" onclick="pgt9()">
                            <label for="36">2010</label>
                        </div>
                    </div>
                </div>
                <div class="perguntas" id="pergunta10" style="display: none;">
                    <h1>Quanto foi o placar do jogo entre Corinthians e Palmeiras que aconteceu as embaixadinhas de
                        Edilson Capetinha?</h1>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="37" value="Corinthians 2x2 Palmeiras"
                                onclick="pgt10()">
                            <label for="37">Corinthians 2x2 Palmeiras</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="38" value="Corinthians 3x3 Palmeiras"
                                onclick="pgt10()">
                            <label for="38">Corinthians 3x3 Palmeiras</label>
                        </div>
                    </div>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="39" value="Corinthians 1x0 Palmeiras"
                                onclick="pgt10()">
                            <label for="39">Corinthians 1x0 Palmeiras</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="40" value="Corinthians 2x0 Palmeiras"
                                onclick="pgt10()">
                            <label for="40">Corinthians 2x0 Palmeiras</label>
                        </div>
                    </div>
                </div>
                <div class="perguntas" id="pergunta11" style="display: none;">
                    <h1>Quem é o maior artilheiro do Corinthians na Libertadores?</h1>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="41" value="Vampeta" onclick="pgt11()">
                            <label for="41">Vampeta</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="42" value="Marcelinho Carioca" onclick="pgt11()">
                            <label for="42">Marcelinho Carioca</label>
                        </div>
                    </div>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="43" value="Emerson Sheik" onclick="pgt11()">
                            <label for="43">Emerson Sheik</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="44" value="Luizão" onclick="pgt11()">
                            <label for="44">Luizão</label>
                        </div>
                    </div>
                </div>
                <div class="perguntas" id="pergunta12" style="display: none;">
                    <h1>Quanto foi o placar agregado da final da Libertadores de 2012?</h1>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="45" value="Corinthians 1x0 Boca Juniors"
                                onclick="pgt12()">
                            <label for="45">Corinthians 1x0 Boca Juniors</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="46" value="Corinthians 3x1 Boca Juniors"
                                onclick="pgt12()">
                            <label for="46">Corinthians 3x1 Boca Juniors</label>
                        </div>
                    </div>
                    <div class="box-alternativas">
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="47" value="Corinthians 3x2 Boca Juniors"
                                onclick="pgt12()">
                            <label for="47">Corinthians 3x2 Boca Juniors</label>
                        </div>
                        <div class="alternativa">
                            <input type="radio" name="pergunta" id="48" value="Corinthians 2x0 Boca Juniors"
                                onclick="pgt12()">
                            <label for="48">Corinthians 2x0 Boca Juniors</label>
                        </div>
                    </div>
                </div>

                <div class="fimQuiz" id="acertos" style="display: none;">
                    <div class="container">
                        <div class="acertos">
                            <h2>Você acertou <span id="b_acertos">X</span> perguntas!</h3>
                                <img src="" alt="">
                                <h3>Veja o seu resultado comparado aos outros usuarios:</h3>
                                <div class="graph">
                                    <canvas id="myChart"></canvas>
                                </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- COMEÇO FOOTER -->
        <div class="footer">
            <div class="container">
                <h4>O Corinthians não é só um time e uma torcida. É um estado de espírito! - Doutor Sócrates
                    <br>
                    <span class="version">
                        Desenvolvido por Raul Oliveira
                    </span>
                </h4>
            </div>
        </div>
        <!-- FIM FOOTER -->
</body>

</html>
<script>
    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;
    var fkUsuario = sessionStorage.ID_USUARIO
    var contAcertos = 0
    const respCertas = ["Corinthians 11x0 Santos", "2013", "Jô", "2017", "Dida", "Lucas Moura", "1976", "Wladimir", "2009", "Corinthians 2x2 Palmeiras", "Luizão", "Corinthians 3x1 Boca Juniors"]

    function pgt1() {
        var resp = document.getElementsByTagName('input')

        for (let index = 0; index < resp.length; index++) {
            if (resp[index].type == "radio") {
                if (resp[index].checked == true) {
                    if (resp[index].value == respCertas[0]) {

                        contAcertos++
                        console.log('Está certo')
                        break
                    } else {
                        console.log('Está errado')
                        break
                    }
                }
            }
        }
        pergunta1.style.display = 'none'
        pergunta2.style.display = 'block'


    }

    function pgt2() {
        var resp = document.getElementsByTagName('input')

        for (let index = 0; index < resp.length; index++) {
            if (resp[index].type == "radio") {
                if (resp[index].checked == true) {
                    if (resp[index].value == respCertas[1]) {

                        contAcertos++
                        console.log('Está certo')
                        break
                    } else {
                        console.log('Está errado')
                        break
                    }
                }
            }
        }
        pergunta2.style.display = 'none'
        pergunta3.style.display = 'block'
    }

    function pgt3() {
        var resp = document.getElementsByTagName('input')

        for (let index = 0; index < resp.length; index++) {
            if (resp[index].type == "radio") {
                if (resp[index].checked == true) {
                    if (resp[index].value == respCertas[2]) {
                        contAcertos++
                        console.log('Está certo')
                        break
                    } else {
                        console.log('Está errado')
                        break
                    }
                }
            }
        }
        pergunta3.style.display = 'none'
        pergunta4.style.display = 'block'
    }

    function pgt4() {
        var resp = document.getElementsByTagName('input')

        for (let index = 0; index < resp.length; index++) {
            if (resp[index].type == "radio") {
                if (resp[index].checked == true) {
                    if (resp[index].value == respCertas[3]) {

                        contAcertos++
                        console.log('Está certo')
                        break
                    } else {
                        console.log('Está errado')
                        break
                    }
                }
            }
        }
        pergunta4.style.display = 'none'
        pergunta5.style.display = 'block'
    }

    function pgt5() {
        var resp = document.getElementsByTagName('input')

        for (let index = 0; index < resp.length; index++) {
            if (resp[index].type == "radio") {
                if (resp[index].checked == true) {
                    if (resp[index].value == respCertas[4]) {

                        contAcertos++
                        console.log('Está certo')
                        break
                    } else {
                        console.log('Está errado')
                        break
                    }
                }
            }
        }
        pergunta5.style.display = 'none'
        pergunta6.style.display = 'block'
    }

    function pgt6() {
        var resp = document.getElementsByTagName('input')

        for (let index = 0; index < resp.length; index++) {
            if (resp[index].type == "radio") {
                if (resp[index].checked == true) {
                    if (resp[index].value == respCertas[5]) {

                        contAcertos++
                        console.log('Está certo')
                        break
                    } else {
                        console.log('Está errado')
                        break
                    }
                }
            }
        }
        pergunta6.style.display = 'none'
        pergunta7.style.display = 'block'
    }

    function pgt7() {
        var resp = document.getElementsByTagName('input')

        for (let index = 0; index < resp.length; index++) {
            if (resp[index].type == "radio") {
                if (resp[index].checked == true) {
                    if (resp[index].value == respCertas[6]) {

                        contAcertos++
                        console.log('Está certo')
                        break
                    } else {
                        console.log('Está errado')
                        break
                    }
                }
            }
        }
        pergunta7.style.display = 'none'
        pergunta8.style.display = 'block'
    }

    function pgt8() {
        var resp = document.getElementsByTagName('input')

        for (let index = 0; index < resp.length; index++) {
            if (resp[index].type == "radio") {
                if (resp[index].checked == true) {
                    if (resp[index].value == respCertas[7]) {

                        contAcertos++
                        console.log('Está certo')
                        break
                    } else {
                        console.log('Está errado')
                        break
                    }
                }
            }
        }
        pergunta8.style.display = 'none'
        pergunta9.style.display = 'block'
    }

    function pgt9() {
        var resp = document.getElementsByTagName('input')

        for (let index = 0; index < resp.length; index++) {
            if (resp[index].type == "radio") {
                if (resp[index].checked == true) {
                    if (resp[index].value == respCertas[8]) {

                        contAcertos++
                        console.log('Está certo')
                        break
                    } else {
                        console.log('Está errado')
                        break
                    }
                }
            }
        }
        pergunta9.style.display = 'none'
        pergunta10.style.display = 'block'
    }
    function pgt10() {
        var resp = document.getElementsByTagName('input')

        for (let index = 0; index < resp.length; index++) {
            if (resp[index].type == "radio") {
                if (resp[index].checked == true) {
                    if (resp[index].value == respCertas[9]) {

                        contAcertos++
                        console.log('Está certo')
                        break
                    } else {
                        console.log('Está errado')
                        break
                    }
                }
            }
        }
        pergunta10.style.display = 'none'
        pergunta11.style.display = 'block'
    }
    function pgt11() {
        var resp = document.getElementsByTagName('input')

        for (let index = 0; index < resp.length; index++) {
            if (resp[index].type == "radio") {
                if (resp[index].checked == true) {
                    if (resp[index].value == respCertas[10]) {

                        contAcertos++
                        console.log('Está certo')
                        break
                    } else {
                        console.log('Está errado')
                        break
                    }
                }
            }
        }
        pergunta11.style.display = 'none'
        pergunta12.style.display = 'block'
    }
    function pgt12() {
        var resp = document.getElementsByTagName('input')

        for (let index = 0; index < resp.length; index++) {
            if (resp[index].type == "radio") {
                if (resp[index].checked == true) {
                    if (resp[index].value == respCertas[10]) {

                        contAcertos++
                        console.log('Está certo')
                        break
                    } else {
                        console.log('Está errado')
                        break
                    }
                }
            }
        }
        pergunta12.style.display = 'none'
        carregarQuiz()
    }

    function carregarQuiz() {
        cadastrar()
        obterDadosGrafico()
        exibirAcertos()

    }

    function cadastrar() {
        // aguardar();

        //Recupere o valor da nova input pelo nome do id
        // Agora vá para o método fetch logo abaixo
        var acertosVar = contAcertos;
        var usuarioVar = sessionStorage.ID_USUARIO;

        // Enviando o valor da nova input
        fetch("/quiz/enviar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                acertosServer: acertosVar,
                usuarioServer: usuarioVar
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                console.log('TuDO CERTO!')
            } else {
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });

    }

    function obterDadosGrafico() {
        fetch(`/medidas/pegarPontuacao/${fkUsuario}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    function plotarGrafico() {

        console.log('iniciando plotagem do gráfico...');

        // Criando estrutura para plotar gráfico - labels
        let labels = [];

        // Criando estrutura para plotar gráfico - dados
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Umidade',
                data: [12, 51, 15, 22, 33, 24],
                fill: false,
                borderColor: 'rgb(75, 192, 192)',
                tension: 0.1
            },
            {
                label: 'Temperatura',
                data: [12, 51, 15, 22, 33, 24],
                fill: false,
                borderColor: 'rgb(199, 52, 52)',
                tension: 0.1
            }]
        };

        console.log('----------------------------------------------')
        console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
        console.log(resposta)

        // Inserindo valores recebidos em estrutura para plotar o gráfico
        for (i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            labels.push(registro.momento_grafico);
            dados.datasets[0].data.push(registro.umidade);
            dados.datasets[1].data.push(registro.temperatura);
        }

        console.log('----------------------------------------------')
        console.log('O gráfico será plotado com os respectivos valores:')
        console.log('Labels:')
        console.log(labels)
        console.log('Dados:')
        console.log(dados.datasets)
        console.log('----------------------------------------------')

        // Criando estrutura para plotar gráfico - config
        const config = {
            type: 'line',
            data: dados,
        };

        // Adicionando gráfico criado em div na tela
        let myChart = new Chart(
            ddocument.getElementById('myChart'),
            config
        );

        const ctx = document.getElementById('myChart');

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Tentativa 1', 'Tentativa 2', 'Tentativa 3', 'Tentativa 4', 'Tentativa 5', 'Tentativa 6'],
                datasets: [{
                    label: '# of Votes',
                    data: [12, 19, 3, 5, 2, 3],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
        setTimeout(() => atualizarGrafico(idInteracao, dados, myChart), 2000);
    }

    function exibirAcertos() {
        acertos.style.display = 'block'
    }
</script>